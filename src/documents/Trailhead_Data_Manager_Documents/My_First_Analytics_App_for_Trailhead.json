{"Compute_Historical_Trending_Fields":{"parameters":{"source":"Add_Unique_Sort_Key_to_OpportunityHistory","partitionBy":["OpportunityId__c"],"orderBy":[{"name":"CreatedDate","direction":"asc"}],"computedFields":[{"name":"OpportunityCreatedDate","label":"OpportunityCreatedDate","expression":{"sourceField":"CreatedDate","offset":"first()","default":"current()"},"description":"Opportunity Created Date"},{"name":"ValidToDate","label":"ValidToDate","expression":{"sourceField":"CreatedDate","offset":"next()","default":"3000-01-01T00:00:00.000Z"},"description":"ValidToDate"},{"name":"ValidFromDate","label":"ValidFromDate","expression":{"sourceField":"CreatedDate","offset":"current()","default":"current()"},"description":"ValidFromDate"},{"name":"AmountPrev","label":"AmountPrev","expression":{"sourceField":"Amount__c","offset":"previous()","default":"0"},"description":"AmountPrev"},{"name":"StageNamePrev","label":"Prev Stage Name","expression":{"sourceField":"StageName__c","offset":"previous()","default":null},"description":"Previous Stage Name"},{"name":"ForecastCategoryPrev","label":"ForecastCategoryPrev","expression":{"sourceField":"ForecastCategory__c","offset":"previous()","default":null},"description":"ForecastCategoryPrev"},{"name":"CloseDatePrev","label":"Prev Close Date","expression":{"sourceField":"CloseDate__c","offset":"previous()","default":"1970-01-01"},"description":"Previous Close Date"},{"name":"CreatedDatePrev","label":"Prev CreatedDate","expression":{"sourceField":"CreatedDate","offset":"previous()","default":null},"description":"Previous Created Date"},{"label":"To ForecastCategory","name":"ForecastCategory","expression":{"offset":"current()","default":null,"sourceField":"ForecastCategory__c"}},{"label":"Amount","name":"Amount","expression":{"offset":"current()","default":"0","sourceField":"Amount__c"}},{"label":"Close Date","name":"CloseDate","expression":{"offset":"current()","default":"current()","sourceField":"CloseDate__c"}},{"label":"Opportunity ID","name":"OpportunityId","expression":{"offset":"current()","default":"current()","sourceField":"OpportunityId__c"}},{"label":"Stage Name","name":"StageName","expression":{"offset":"current()","default":null,"sourceField":"StageName__c"}}]},"action":"computeRelative"},"Extract_OpportunityHistory":{"schema":{"objects":[{"label":"OpportunityHistory","fields":[{"name":"CreatedDate","label":"CreatedDate","format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","description":"Opportunity Created Date"},{"name":"Amount__c","label":"Amount","description":"Amount"}]}]},"parameters":{"object":"OpportunityHistory__c","fields":[{"name":"Amount__c"},{"name":"CloseDate__c"},{"name":"CreatedById"},{"name":"CreatedDate"},{"name":"ForecastCategory__c"},{"name":"Id"},{"name":"IsDeleted"},{"name":"OpportunityId__c"},{"name":"StageName__c"}]},"action":"sfdcDigest"},"Filter_User":{"parameters":{"source":"Extract_User","filter":"IsActive:EQ:true|false"},"action":"filter"},"User_with_Roles_with_Opportunities":{"parameters":{"relationship":"Opportunity","right":"Extract_Opportunity","right_select":["Name"],"left_key":["Id"],"left":"User_with_Roles","right_key":["OwnerId"]},"action":"augment","_comment":"Get user's role hierarchy"},"Register_Case":{"parameters":{"source":"Join_CaseAccount_Oppty","alias":"case","name":"Cases","rowLevelSecurityFilter":"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Opportunity_Products_Custom_Filter_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"\"true\"","name":"CustomFilter"}],"mergeWithSource":true,"source":"Add_Fields_To_Oppty_Product"},"action":"computeExpression"},"Add_Fields_To_Opportunity":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Numeric","label":"Days Since Last Activity","scale":0,"saqlExpression":"case    when LastActivityDate is null      then daysBetween(toDate(LastModifiedDate_sec_epoch), now())   when LastModifiedDate > LastActivityDate     then daysBetween(toDate(LastModifiedDate_sec_epoch), now())   else daysBetween(toDate(LastActivityDate_sec_epoch), now()) end","name":"DaysSinceLastActivity","precision":8},{"type":"Numeric","label":"Opportunity Age","scale":0,"saqlExpression":"case    when IsClosed == \"false\"     then daysBetween(toDate(CreatedDate_sec_epoch), now())     else daysBetween(toDate(CreatedDate_sec_epoch),toDate(CloseDate_sec_epoch))     end","name":"OpportunityAge","precision":8}],"source":"Extract_Opportunity"},"action":"computeExpression"},"Join_OpportunityOwner_Product":{"parameters":{"operation":"LookupMultiValue","relationship":"Product","right":"Add_Fields_To_Oppty_Product","right_select":["Product.Family","Product.Name"],"left_key":["Id"],"left":"Join_OpportunityOwner","right_key":["OpportunityId"]},"action":"augment"},"Add_Fields_To_Task":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"EventSubtype","saqlExpression":"TaskSubtype","name":"EventSubtype"},{"type":"Numeric","label":"DurationInMinutes","scale":0,"saqlExpression":"0","name":"DurationInMinutes","precision":8,"defaultValue":"0"}],"source":"Extract_Task"},"action":"computeExpression"},"Extract_Quota":{"parameters":{"alias":"plain_quota"},"action":"edgemart"},"Join_OpportunityOpportunityLineItemPricebookEntryProduct":{"parameters":{"relationship":"Opportunity","right":"Join_OpportunityOwner","right_select":["Name","StageName","CloseDate","IsWon","Type","IsClosed","LeadSource","ForecastCategory","ForecastCategoryName","CreatedDate","AccountId","Account.Name","Account.OwnerId","Account.Type","Account.Industry","Account.BillingCountry","Account.BillingState","Account.AccountSource","Account.NumberOfEmployees","Account.AnnualRevenue","Account.Owner.Name","Account.Owner.UniqueUserName","Account.Owner.Role.Name","Account.Owner.Role.Roles","Account.Owner.Role.RolePath","OwnerId","Owner.Name","Owner.FullPhotoUrl","Owner.SmallPhotoUrl","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RoleNames","Owner.Role.RolePath","Owner.Role.ParentRoleId","Owner.Role.ParentRole.DeveloperName","RecordTypeId","RecordType.Name","OpportunityAge","DaysSinceLastActivity","Neglected"],"left_key":["OpportunityId"],"left":"Join_OpportunityLineItemPricebookEntryProduct","right_key":["Id"]},"action":"augment"},"Add_Unique_Sort_Key_to_OpportunityHistory":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"'CreatedDate' + \"-\" +  'Id'","name":"Unique_Sort_Key","defaultValue":"'CreatedDate'"}],"mergeWithSource":true,"source":"Extract_OpportunityHistory"},"action":"computeExpression"},"Compute_Opportunities_No_Products_Id":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"Id","saqlExpression":"\"N/A\"","name":"Id"}],"source":"Compute_Opportunities_No_Products"},"action":"computeExpression"},"Create_StageName_Multi_Value_Key":{"parameters":{"operation":"LookupMultiValue","relationship":"Stage","right":"Join_OpportunityStage_Previous","right_select":["StageName","IsPushed","IsPulled"],"left_key":["Id"],"left":"Join_Time_In_Current_Stage_to_Opportunity","right_key":["OpportunityId"]},"action":"augment"},"Join_OpportunityStage_Previous_with_Opp_Amount_Product":{"parameters":{"operation":"LookupMultiValue","relationship":"Opportunity","right":"Add_Fields_To_Oppty_Product","right_select":["Product.Family","Product.Name"],"left_key":["OpportunityId"],"left":"Join_OpportunityStage_Previous_with_Opp_Amount","right_key":["OpportunityId"]},"action":"augment"},"Activity_Custom_Filter_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"\"true\"","name":"CustomFilter"}],"mergeWithSource":true,"source":"Compute_Activity_Days_Overdue"},"action":"computeExpression"},"compute_CalculatedCaseDuration":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Numeric","label":"Case Duration","scale":2,"saqlExpression":"case  when ('IsClosed' == \"true\") then ('ClosedDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400   else ('CurrentDate_sec_epoch' - 'CreatedDate_sec_epoch')/86400  end","name":"DurationCalculatedField","precision":18,"defaultValue":"0"}],"source":"compute_CurrentDateForCase"},"action":"computeExpression"},"Account_Custom_Filter_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"\"true\"","name":"CustomFilter"}],"mergeWithSource":true,"source":"Join_AccountOwner"},"action":"computeExpression"},"Find_Last_Stage_Updates":{"parameters":{"computedFields":[{"label":"LastStageUpdate_Id","description":"Final Stage Change Id","name":"LastStageUpdate_Id","expression":{"offset":"first()","default":"current()","sourceField":"Id"}}],"source":"Filter_Out_Stage_Updates","orderBy":[{"direction":"desc","name":"Unique_Sort_Key"}],"partitionBy":["OpportunityId"]},"action":"computeRelative"},"Add_Neglected_To_Opportunity":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"Neglected","saqlExpression":"case when DaysSinceLastActivity >= 60 then \"true\" else \"false\" end","name":"Neglected"}],"source":"Add_Fields_To_Opportunity"},"action":"computeExpression"},"Filter_WonOppty":{"parameters":{"source":"Join_OpportunityAccount","filter":"IsWon:EQ:true"},"action":"filter"},"Join_Time_In_Current_Stage_to_Opportunity":{"parameters":{"relationship":"Time_In_Current_Stage","right":"Calculate_Current_Stage_Duration","right_select":["Duration_Seconds"],"left_key":["Id"],"left":"Join_OpportunityRecordType","right_key":["OpportunityId"]},"action":"augment"},"Filter_Activity":{"parameters":{"source":"Activity_Custom_Filter_Flag","filter":"CustomFilter:EQ:true"},"action":"filter"},"Register_Opportunity":{"parameters":{"source":"Filter_Opportunity","alias":"opportunity","name":"Opportunities","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Account.OwnerId' == \"$User.Id\"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Join_ActivityOwner":{"parameters":{"relationship":"Owner","right":"User_with_Roles","right_select":["Name","Username","UserRoleId","UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"left_key":["OwnerId"],"left":"Append_TaskEvent","right_key":["Id"]},"action":"augment"},"Filter_Out_Last_Stage_Updates":{"parameters":{"source":"Create_IsLastStageUpdate_Field","filter":"IsLastStageUpdate:EQ:1"},"action":"filter"},"Register_Pipeline_Trending":{"parameters":{"source":"Filter_Pipeline_Trending","alias":"pipeline_trending","name":"Pipeline Trending","rowLevelSecurityFilter":"'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\""},"action":"sfdcRegister"},"Filter_Pipeline_Trending":{"parameters":{"source":"Pipeline_Trending_Stage_Conversion_Flag","filter":"CustomFilter:EQ:true"},"action":"filter"},"Extract_OpportunityLineItem":{"parameters":{"object":"OpportunityLineItem","fields":[{"name":"OpportunityId"},{"name":"ProductCode"},{"name":"ListPrice"},{"name":"Quantity"},{"name":"TotalPrice"},{"name":"PricebookEntryId"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Add_Fields_To_Oppty_Product":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"AccountName","saqlExpression":"'Opportunity.Account.Name'","name":"AccountName"}],"source":"Join_OpportunityOpportunityLineItemPricebookEntryProduct"},"action":"computeExpression"},"Join_ActivityOwner_Product_Opp":{"parameters":{"relationship":"Opportunity","right":"Join_OpportunityOwner","right_select":["Id","Name","Type","OwnerId","IsWon","IsClosed","AccountId","CloseDate","StageName","CreatedDate","LeadSource","ForecastCategoryName","Account.Name","Account.Type","Account.Industry","Account.AccountSource","Account.BillingCountry","Account.BillingState","Account.OwnerId","RecordTypeId","RecordType.Name","OpportunityAge","DaysSinceLastActivity","Neglected"],"left_key":["WhatId"],"left":"Join_ActivityOwner_Product","right_key":["Id"]},"action":"augment"},"Pipeline_Trending_Stage_Conversion_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"case when 'Stage.SortOrder' > 'StagePrev.SortOrder' then \"true\" else \"false\" end","name":"Stage_IsAdvanced","defaultValue":"\"true\""}],"mergeWithSource":true,"source":"Pipeline_Trending_Custom_Filter_Flag"},"action":"computeExpression"},"Register_UserManager":{"parameters":{"source":"Filter_UserManager","alias":"user","name":"Users","rowLevelSecurityFilter":"'Role.Roles' == \"$User.UserRoleId\" || 'Id' == \"$User.Id\"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Append_LineItems":{"parameters":{"sources":["Extract_OpportunityLineItem","Compute_Opportunities_No_Products_Id"]},"action":"append"},"Filter_UserManager":{"parameters":{"source":"Users_Custom_Filter_Flag","filter":"CustomFilter:EQ:true"},"action":"filter"},"Register_OpportunityProducts":{"parameters":{"source":"Filter_Opportunity_Products","alias":"opportunity_products","name":"Oppty Products","rowLevelSecurityFilter":"'Opportunity.Owner.Role.Roles' == \"$User.UserRoleId\" || 'Opportunity.OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Extract_Queue":{"parameters":{"object":"Group","complexFilterConditions":"Type = 'Queue'","fields":[{"name":"Id"},{"name":"Name"},{"name":"Type"}]},"action":"sfdcDigest"},"Join_OpportunityLineItemPricebookEntryProduct":{"parameters":{"relationship":"Product","right":"Extract_Product","right_select":["ProductCode","Name","Family"],"left_key":["Pricebook.Product2Id"],"left":"Join_OpportunityLineItemPricebookEntry","right_key":["Id"]},"action":"augment"},"Extract_User":{"parameters":{"object":"User","fields":[{"name":"Id"},{"name":"Username"},{"name":"Name"},{"name":"FirstName"},{"name":"LastName"},{"name":"UserRoleId"},{"name":"UserType"},{"name":"IsActive"},{"name":"FullPhotoUrl"},{"name":"SmallPhotoUrl"},{"name":"ManagerId","defaultValue":"N/A"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Extract_OpportunityAmount":{"parameters":{"object":"Opportunity","fields":[{"name":"Id"},{"name":"Amount"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Join_CaseAccount":{"parameters":{"relationship":"Account","right":"Join_AccountOwner","right_select":["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"left_key":["AccountId"],"left":"compute_CalculatedCaseDuration","right_key":["Id"]},"action":"augment"},"Join_OpportunityStage_Previous":{"parameters":{"relationship":"StagePrev","right":"Extract_OpportunityStage","right_select":["IsClosed","IsWon","SortOrder"],"left_key":["StageNamePrev"],"left":"Join_OpportunityStage","right_key":["MasterLabel"]},"action":"augment"},"Flatten_UserRole":{"parameters":{"source":"Extract_UserRole","path_field":"RolePath","parent_field":"ParentRoleId","multi_field":"Roles","self_field":"Id"},"action":"flatten","schema":{"objects":[{"fields":[{"isSystemField":false,"label":"Roles","name":"Roles"},{"isSystemField":false,"label":"RolePath","name":"RolePath"}],"label":"Flatten_UserRole"}]}},"Extract_Event":{"parameters":{"object":"Event","fields":[{"name":"OwnerId"},{"name":"CreatedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"ActivityDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"Subject"},{"name":"DurationInMinutes"},{"name":"EventSubtype"},{"name":"WhatId"},{"name":"AccountId"}]},"action":"sfdcDigest"},"Pipeline_Trending_Custom_Filter_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"\"true\"","name":"CustomFilter"}],"mergeWithSource":true,"source":"Join_OpportunityStage_Previous_with_Opp_Amount_Product"},"action":"computeExpression"},"User_with_Roles":{"parameters":{"relationship":"Role","right":"Flatten_ParentName","right_select":["Name","DeveloperName","Roles","RolePath","ParentRoleId","ParentRole.Name","ParentRole.DeveloperName","RoleNames","RoleNamesPath"],"left_key":["UserRoleId"],"left":"Compute_Manager_Unique","right_key":["Id"]},"action":"augment","_comment":"Get user's role hierarchy"},"Extract_UserRole":{"parameters":{"object":"UserRole","fields":[{"name":"Id"},{"name":"Name"},{"name":"DeveloperName"},{"name":"ParentRoleId"},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"LastModifiedById"},{"name":"SystemModstamp"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Extract_Account":{"parameters":{"object":"Account","fields":[{"name":"Id"},{"name":"Name"},{"name":"OwnerId"},{"name":"NumberOfEmployees"},{"name":"AnnualRevenue"},{"name":"AccountSource"},{"name":"Type"},{"name":"Industry"},{"name":"BillingCountry"},{"name":"BillingState"},{"name":"CreatedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Join_Quota_User":{"parameters":{"relationship":"User","right":"User_with_Roles","right_select":["Id","Name","Username","UserRoleId","UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"left_key":["Username"],"left":"Extract_Quota","right_key":["Username"]},"action":"augment"},"Flatten_ParentName":{"parameters":{"source":"Augment_ParentName","path_field":"RoleNamesPath","parent_field":"ParentRole.DeveloperName","multi_field":"RoleNames","self_field":"DeveloperName","include_self_id":true},"action":"flatten","schema":{"objects":[{"fields":[{"isSystemField":false,"label":"RoleNames","name":"RoleNames"},{"isSystemField":false,"label":"RoleNamesPath","name":"RoleNamesPath"}],"label":"Flatten_UserRole"}]}},"Extract_RecordTypes":{"parameters":{"object":"RecordType","fields":[{"name":"Name"},{"name":"Id"}]},"action":"sfdcDigest"},"Compute_Opportunities_No_Products":{"parameters":{"mergeWithSource":false,"computedFields":[{"type":"Text","label":"OpportunityId","saqlExpression":"Id","name":"OpportunityId"},{"type":"Text","label":"ProductCode","saqlExpression":"\"N/A\"","name":"ProductCode"},{"type":"Numeric","label":"ListPrice","scale":2,"saqlExpression":"Amount","name":"ListPrice","precision":18},{"type":"Numeric","label":"Quantity","scale":2,"saqlExpression":"1","name":"Quantity","precision":18},{"type":"Numeric","label":"Total Price","scale":2,"saqlExpression":"Amount","name":"TotalPrice","precision":18},{"type":"Text","label":"PricebookEntryId","saqlExpression":"Id","name":"PricebookEntryId"}],"source":"Opportunities_No_Products"},"action":"computeExpression"},"Opportunity_Custom_Filter_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"\"true\"","name":"CustomFilter"}],"mergeWithSource":true,"source":"Join_OpportunityOwner_Product"},"action":"computeExpression"},"Join_OpportunityRecordType":{"parameters":{"relationship":"RecordType","right":"Extract_RecordTypes","right_select":["Name"],"left_key":["RecordTypeId"],"left":"Join_OpportunityOpportunityStage","right_key":["Id"]},"action":"augment"},"Filter_Account":{"parameters":{"source":"Account_Custom_Filter_Flag","filter":"CustomFilter:EQ:true"},"action":"filter"},"Register_QuotaWithRoles":{"parameters":{"source":"Join_Quota_User","alias":"quota","name":"User Allocation","rowLevelSecurityFilter":"'User.Role.Roles' == \"$User.UserRoleId\" || 'User.Id' == \"$User.Id\"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Join_OpportunityAccount":{"parameters":{"relationship":"Account","right":"Join_AccountOwner","right_select":["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"left_key":["AccountId"],"left":"Create_StageName_Multi_Value_Key","right_key":["Id"]},"action":"augment"},"Users_Custom_Filter_Flag":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"case when 'Opportunity.Name' is null then \"false\" else \"true\" end","name":"hasOpportunity"},{"type":"Text","saqlExpression":"case when 'Opportunity.Name' is null && 'IsActive' == \"false\" then \"false\" else \"true\" end","name":"CustomFilter"}],"mergeWithSource":true,"source":"User_with_Roles_with_Opportunities"},"action":"computeExpression"},"Join_ActivityOwner_Product_Opp_User_Account":{"parameters":{"relationship":"Account","right":"Join_AccountOwner","right_select":["Name","Type","Industry","BillingCountry","BillingState","AccountSource","NumberOfEmployees","AnnualRevenue","OwnerId","Owner.Name","Owner.UniqueUserName","Owner.Role.Name","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId"],"left_key":["AccountId"],"left":"Join_ActivityOwner_Product_Opp_User","right_key":["Id"]},"action":"augment"},"Add_Fields_To_Event":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"CallDisposition","saqlExpression":"\"Event\"","name":"CallDisposition"},{"type":"Text","label":"CallType","saqlExpression":"\"Event\"","name":"CallType"},{"type":"Text","label":"Status","saqlExpression":"\"Event\"","name":"Status"},{"type":"Text","label":"Priority","saqlExpression":"\"Event\"","name":"Priority"},{"type":"Text","label":"TaskSubtype","saqlExpression":"EventSubtype","name":"TaskSubtype"},{"type":"Numeric","label":"CallDurationInSeconds","scale":0,"saqlExpression":"0","name":"CallDurationInSeconds","precision":8,"defaultValue":"0"},{"type":"Text","label":"IsClosed","saqlExpression":"case when daysBetween(toDate(ActivityDate_sec_epoch), now()) >= 0 then \"true\" else \"false\" end","name":"IsClosed"}],"source":"Extract_Event"},"action":"computeExpression"},"Compute_Unique_Name":{"parameters":{"computedFields":[{"label":"isDuplicate","description":"isDuplicate","name":"isDuplicate","expression":{"offset":"next()","default":null,"sourceField":"Id"}}],"source":"Filter_User","orderBy":[{"direction":"asc","name":"Id"}],"partitionBy":["Name"]},"action":"computeRelative"},"Join_CaseAccount_Oppty":{"parameters":{"operation":"LookupMultiValue","relationship":"Opportunity","right":"Filter_WonOppty","right_select":["Amount"],"left_key":["AccountId"],"left":"Join_CaseAccount","right_key":["AccountId"]},"action":"augment"},"Join_OpportunityOwner":{"parameters":{"relationship":"Owner","right":"User_with_Roles","right_select":["Name","Username","UserRoleId","UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"left_key":["OwnerId"],"left":"Join_OpportunityAccount","right_key":["Id"]},"action":"augment"},"Register_Account":{"parameters":{"source":"Filter_Account","alias":"account","name":"Accounts","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Add_Fields_to_OpportunityHistory":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"case when 'StageName' == 'StageNamePrev' then \"0\" else \"1\" end","name":"Stage_isUpdated","defaultValue":"\"1\""},{"type":"Text","saqlExpression":"case when 'CloseDatePrev' == 'CloseDate' then \"0\" else \"1\" end","name":"CloseDate_isUpdated","defaultValue":"\"1\""},{"type":"Text","saqlExpression":"case when 'AmountPrev' == 'Amount' then \"0\" else \"1\" end","name":"Amount_isUpdated","defaultValue":"\"1\""},{"type":"Text","label":"IsLastUpdate","saqlExpression":"case when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then \"1\" else \"0\" end","name":"IsLastUpdate"},{"type":"Numeric","scale":0,"saqlExpression":"case when ('CloseDatePrev' != \"1970-1-1\") && ('CloseDatePrev' < 'CloseDate') then 1 else 0 end","name":"IsPushed","precision":8},{"type":"Numeric","scale":0,"saqlExpression":"case when ('CloseDatePrev' != \"1970-1-1\") && ('CloseDatePrev' > 'CloseDate') then 1 else 0 end","name":"IsPulled","precision":8},{"type":"Numeric","label":"Duration","scale":0,"saqlExpression":"case when 'ValidToDate' == \"3000-01-01T00:00:00.000Z\" then     date_diff(\"second\",toDate(ValidFromDate_sec_epoch), now())     else     date_diff(\"second\",toDate(ValidFromDate_sec_epoch), toDate(ValidToDate_sec_epoch))     end","name":"Duration","precision":18}],"mergeWithSource":true,"source":"Compute_Historical_Trending_Fields"},"action":"computeExpression"},"Join_ForecastCategory_Previous":{"parameters":{"relationship":"ForecastCategoryPrev","right":"Extract_OpportunityStage","right_select":["ForecastCategoryName"],"left_key":["ForecastCategory"],"left":"Join_ForecastCategory","right_key":["ForecastCategory"]},"action":"augment"},"Append_TaskEvent":{"parameters":{"sources":["Add_Fields_To_Task","Add_Fields_To_Event"]},"action":"append"},"Join_AccountOwner":{"parameters":{"relationship":"Owner","right":"User_with_Roles","right_select":["Name","Username","UserRoleId","UniqueUserName","FullPhotoUrl","SmallPhotoUrl","Role.Name","Role.DeveloperName","Role.Roles","Role.RolePath","Role.ParentRoleId","Role.ParentRole.Name","Role.ParentRole.DeveloperName","Role.RoleNames","Role.RoleNamesPath"],"left_key":["OwnerId"],"left":"Add_Fields_To_Account","right_key":["Id"]},"action":"augment"},"Extract_Task":{"parameters":{"object":"Task","fields":[{"name":"Id"},{"name":"CallDurationInSeconds"},{"name":"CallDisposition"},{"name":"CallType"},{"name":"OwnerId"},{"name":"Status"},{"name":"Priority"},{"name":"IsClosed"},{"name":"TaskSubtype"},{"name":"CreatedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"ActivityDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"Subject"},{"name":"WhatId"},{"name":"AccountId"}]},"action":"sfdcDigest"},"Join_OpportunityLineItemPricebookEntry":{"parameters":{"relationship":"Pricebook","right":"Extract_PricebookEntry","right_select":["Product2Id"],"left_key":["PricebookEntryId"],"left":"Discount_Field","right_key":["Id"]},"action":"augment"},"Compute_Manager_Unique":{"parameters":{"computedFields":[{"type":"Text","saqlExpression":"case when isDuplicate is null then 'Name' else 'Name' + \" (\" +'Username'+ \")\" end","name":"UniqueUserName"}],"mergeWithSource":true,"source":"Compute_Unique_Name"},"action":"computeExpression"},"Join_ForecastCategory":{"parameters":{"relationship":"ForecastCategory","right":"Extract_OpportunityStage","right_select":["ForecastCategoryName"],"left_key":["ForecastCategory"],"left":"Join_OpportunityStage_Previous","right_key":["ForecastCategory"]},"action":"augment"},"Filter_Opportunity":{"parameters":{"source":"Opportunity_Custom_Filter_Flag","filter":"CustomFilter:EQ:true"},"action":"filter"},"Discount_Field":{"parameters":{"computedFields":[{"type":"Numeric","scale":6,"saqlExpression":"1-(('TotalPrice')/('ListPrice' * 'Quantity'))","name":"Discount_Percent","precision":7},{"type":"Numeric","scale":6,"saqlExpression":"'ListPrice' * 'Quantity'","name":"Total_ListPrice","precision":7}],"mergeWithSource":true,"source":"Append_LineItems"},"action":"computeExpression"},"Compute_Activity_Days_Overdue":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Numeric","label":"Days Overdue","scale":2,"saqlExpression":"case when 'IsOverdue' == \"true\" then daysBetween(toDate(substr('ActivityDate', 1, 10), \"yyyy-MM-dd\"), now()) else 0 end","name":"DaysOverdue","precision":18,"defaultValue":"0"}],"source":"Compute_Activity_IsOverdue"},"action":"computeExpression"},"Filter_Out_Stage_Updates":{"parameters":{"source":"Add_Fields_to_OpportunityHistory","filter":"Stage_isUpdated:EQ:1"},"action":"filter"},"Opportunities_No_Products":{"parameters":{"source":"Add_Neglected_To_Opportunity","filter":"HasOpportunityLineItem:EQ:false"},"action":"filter"},"Filter_Opportunity_Products":{"parameters":{"source":"Opportunity_Products_Custom_Filter_Flag","filter":"CustomFilter:EQ:true"},"action":"filter"},"Add_Fields_To_Account":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"Account Name","saqlExpression":"'Name'","name":"AccountName"}],"source":"Extract_Account"},"action":"computeExpression"},"Join_OpportunityOpportunityStage":{"parameters":{"relationship":"Stage","right":"Extract_OpportunityStage","right_select":["SortOrder","DefaultProbability"],"left_key":["StageName"],"left":"Add_Neglected_To_Opportunity","right_key":["MasterLabel"]},"action":"augment"},"Create_IsLastStageUpdate_Field":{"parameters":{"computedFields":[{"type":"Text","label":"IsLastStageUpdate","saqlExpression":"case when 'LastStageUpdate_Id' == 'Id' then \"1\" else \"0\" end","name":"IsLastStageUpdate"}],"mergeWithSource":true,"source":"Find_Last_Stage_Updates"},"action":"computeExpression"},"Augment_ParentName":{"parameters":{"relationship":"ParentRole","right":"Extract_UserRole","right_select":["Name","DeveloperName","ParentRoleId"],"left_key":["ParentRoleId"],"left":"Flatten_UserRole","right_key":["Id"]},"action":"augment","_comment":"get parent role's rolename"},"Register_Product":{"parameters":{"source":"Extract_Product","alias":"product","name":"Products","rowLevelSecurityFilter":"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"compute_CurrentDateForCase":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Date","label":"CurrentDate","saqlExpression":"now()","name":"CurrentDate","format":"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"}],"source":"Extract_Case"},"action":"computeExpression"},"Register_UserRole":{"parameters":{"source":"Flatten_ParentName","alias":"user_role","name":"Roles","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Compute_Activity_IsOverdue":{"parameters":{"mergeWithSource":true,"computedFields":[{"type":"Text","label":"IsOverdue","saqlExpression":"case when ('IsClosed' == \"false\") && (daysBetween(toDate(substr('ActivityDate', 1, 10), \"yyyy-MM-dd\"), now()) > 0) then \"true\" else \"false\" end","name":"IsOverdue"}],"source":"Join_ActivityOwner_Product_Opp_User_Account"},"action":"computeExpression"},"Calculate_Current_Stage_Duration":{"parameters":{"computedFields":[{"type":"Numeric","label":"Duration","scale":0,"saqlExpression":"date_diff(\"second\",toDate(ValidFromDate_sec_epoch), now())","name":"Duration_Seconds","precision":18}],"mergeWithSource":true,"source":"Filter_Out_Last_Stage_Updates"},"action":"computeExpression"},"Register_Activity":{"parameters":{"source":"Filter_Activity","alias":"activity","name":"Activities","rowLevelSecurityFilter":"'Owner.Role.Roles' == \"$User.UserRoleId\" || 'OwnerId' == \"$User.Id\" || 'Opportunity.Account.OwnerId' == \"$User.Id\"","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Join_ActivityOwner_Product":{"parameters":{"operation":"LookupMultiValue","relationship":"Opportunity","right":"Add_Fields_To_Oppty_Product","right_select":["Product.Family","Product.Name"],"left_key":["WhatId"],"left":"Join_ActivityOwner","right_key":["OpportunityId"]},"action":"augment"},"Join_OpportunityStage":{"parameters":{"relationship":"Stage","right":"Extract_OpportunityStage","right_select":["IsClosed","IsWon","SortOrder"],"left_key":["StageName"],"left":"Add_Fields_to_OpportunityHistory","right_key":["MasterLabel"]},"action":"augment"},"Join_Time_In_Current_Stage_to_Pipeline_Trending":{"parameters":{"relationship":"Time_In_Current_Stage","right":"Calculate_Current_Stage_Duration","right_select":["Duration_Seconds"],"left_key":["OpportunityId"],"left":"Join_ForecastCategory_Previous","right_key":["OpportunityId"]},"action":"augment"},"Register_PlainQuota":{"parameters":{"source":"Extract_Quota","alias":"plain_quota","name":"Quota","SFDCtoken":"SFDCtoken"},"action":"sfdcRegister"},"Join_OpportunityStage_Previous_with_Opp_Amount":{"parameters":{"relationship":"Opportunity","right":"Extract_OpportunityAmount","right_select":["Amount"],"left_key":["OpportunityId"],"left":"Join_OpportunityStage_Previous_with_Opp","right_key":["Id"]},"action":"augment"},"Join_OpportunityStage_Previous_with_Opp":{"parameters":{"relationship":"Opportunity","right":"Join_OpportunityOwner","right_select":["Name","Type","IsWon","IsClosed","Stage.SortOrder","OwnerId","AccountId","CloseDate","StageName","LeadSource","ForecastCategoryName","Account.Name","Account.Type","Account.Industry","Account.AccountSource","Account.BillingState","Account.BillingCountry","Account.OwnerId","Account.Owner.Name","Owner.Name","Owner.FullPhotoUrl","Owner.SmallPhotoUrl","Owner.UniqueUserName","Owner.Role.RoleNames","Owner.Role.Name","Owner.Role.DeveloperName","Owner.Role.Roles","Owner.Role.RolePath","Owner.Role.ParentRoleId","Owner.Role.ParentRole.Name","Owner.Role.ParentRole.DeveloperName","RecordTypeId","RecordType.Name"],"left_key":["OpportunityId"],"left":"Join_Time_In_Current_Stage_to_Pipeline_Trending","right_key":["Id"]},"action":"augment"},"Extract_OpportunityStage":{"parameters":{"object":"OpportunityStage","fields":[{"name":"IsClosed"},{"name":"CreatedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"Description"},{"name":"ForecastCategory"},{"name":"ForecastCategoryName"},{"name":"IsActive"},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"MasterLabel"},{"name":"Id"},{"name":"DefaultProbability"},{"name":"SortOrder"},{"name":"SystemModstamp"},{"name":"IsWon"}]},"action":"sfdcDigest"},"Extract_Case":{"parameters":{"object":"Case","fields":[{"name":"AccountId"},{"name":"ContactId"},{"name":"OwnerId"},{"name":"Id"},{"name":"IsClosed"},{"name":"Origin"},{"name":"Type"},{"name":"Subject"},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"CreatedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"ClosedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"IsEscalated"},{"name":"Status"},{"name":"CaseNumber"}]},"action":"sfdcDigest"},"Join_ActivityOwner_Product_Opp_User":{"parameters":{"relationship":"AssignedTo","right":"Compute_Manager_Unique","right_select":["Name","UniqueUserName"],"left_key":["OwnerId"],"left":"Join_ActivityOwner_Product_Opp","right_key":["Id"]},"action":"augment"},"Join_User_Manager":{"parameters":{"relationship":"UserManager","right":"Compute_Manager_Unique","right_select":["Name","Username","FullPhotoUrl","SmallPhotoUrl","UserRoleId","Id","UniqueUserName"],"left_key":["Id"],"left":"Compute_Manager_Unique","right_key":["ManagerId"]},"action":"augment"},"Extract_Product":{"parameters":{"object":"Product2","fields":[{"name":"Id"},{"name":"ProductCode"},{"name":"Name"},{"name":"Family"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Extract_Opportunity":{"parameters":{"object":"Opportunity","fields":[{"name":"Id"},{"name":"AccountId"},{"name":"OwnerId"},{"name":"Name"},{"name":"StageName"},{"name":"LeadSource"},{"name":"IsWon"},{"name":"Type"},{"name":"IsClosed"},{"name":"ForecastCategory"},{"name":"ForecastCategoryName"},{"name":"CreatedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"CloseDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"Amount"},{"name":"CreatedById"},{"name":"LastModifiedDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"LastActivityDate","firstDayOfWeek":0,"fiscalMonthOffset":0},{"name":"HasOpportunityLineItem"},{"name":"RecordTypeId"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"},"Extract_PricebookEntry":{"parameters":{"object":"PricebookEntry","fields":[{"name":"Id"},{"name":"Product2Id"}],"SFDCtoken":"SFDCtoken"},"action":"sfdcDigest"}}